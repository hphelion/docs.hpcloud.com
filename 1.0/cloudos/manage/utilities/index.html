<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/cloudos/manage/utilities/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:03:18 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>HP Cloud OS Utilities</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../css/combined.css">

	<script src="../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../index.html" class="logo"  ><img src="../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<script>
<![CDATA[

function PageRefresh {
onLoad="window.refresh"
}

PageRefresh();

]]>
</script><p style="font-size: small;"> <a href="../index.html">◀ PREV</a> | <a href="../index.html">▲ UP</a> | <a href="../troubleshooting/index.html">NEXT ▶</a> </p>

<h1 id="hp-cloud-os-utilities">HP Cloud OS Utilities</h1>

<p>The current release features the HP Cloud OS Clean-up Utility. Additional utilities may be added in future releases and described in this topic.</p>

<h2 id="hp-cloud-os-clean-up-utility">HP Cloud OS Clean-up Utility</h2>

<p>The HP Cloud OS Clean-up Utility ensures that the databases used to store data within HP Cloud OS are kept clean, 
and do not retain and accumulate data that is no longer being accessed.</p>

<h3 id="overview">Overview</h3>

<p>The HP Cloud OS Clean-up Utility ensures that the HP Cloud OS and OpenStack databases are running smoothly and the databases are clean. 
The utility uses the Nagios web interface for scheduling database clean-up tasks.</p>

<p>It is possible for a HP Cloud OS or OpenStack resource in one table to be reliant on a resource in another table with 
no foreign key reference. If the dependent resource were simply deleted, a dangling reference in the referring table 
would result. Likewise, if there are two tables with foreign key relationships and the data is deleted in one table 
but not the other, referential integrity is broken.</p>

<p>As an example, a user entity may be associated with various resources in the system-projects, templates, key pairs, security groups, 
and so on. If the user represents an employee who has left the organization, and that user is removed in the Administration Dashboard, 
the data representing the user is marked for deletion in HP Cloud OS, but it is important that the data not be removed from the 
database until the associated data can be removed with the Clean-up Utility.</p>

<p>The HP Cloud OS Clean-up Utility addresses referential integrity issues by running a number of tasks that are offered as 
Nagios services. Running these tasks regularly keeps the HP Cloud OS and OpenStack databases clean.</p>

<p>This section includes:</p>

<ul><li><p><a href="#clean-up-tasks">Clean-up Tasks</a></p></li>
<li><p><a href="#using-nagios">Using Nagios</a></p></li>
</ul><h2 id="clean-up-tasks">Clean-up Tasks</h2>

<p>The HP Cloud OS Clean-up Utility performs the following tasks:</p>

<ul><li><p>Clean up all resources associated with previously deleted resources. The HP Cloud OS Administration Dashboard does not 
delete projects or users. Instead, it "moves them to the trash can" by removing as many resources as possible and then 
prefixing the Project (or User) name with a tilde ~. Flavors are already only "marked for deletion" in the database.</p></li>
<li><p>Prevent select HP Cloud OS database entries from existing in their respective tables longer than 24-Hours.</p></li>
<li><p>Ensure that all of the database tables are referentially accurate. In other words, Cloud Utils cleans the database of all invalid data.</p></li>
<li><p>Monitor key services to ensure that they are in a run state.</p></li>
</ul><p>The Clean-up Utility runs every 24 hours by default, between 23:00 and 00:00 hours local time, but can be scheduled 
through Nagios to run whenever the admin needs to clean up the database.</p>

<p>The Clean-up Utility consists of the following four Nagios services:</p>

<ul><li><p><strong>Cloud clean db objects</strong> — Cleans up the user and all the key pairs associated with that user from the database. 
For projects, removes the element from the database table or sets the "elements deleted" flag for the project. 
Removes hardware flavors that are marked for deletion and are no longer being used by a VM instance. 
Cleans up tokens that are expired for more than 24 hour, and for roles, removes the roles from the database table.</p></li>
<li><p><strong>Cloud clean deleted objects</strong> —-Cleans up referential integrity issues in the database.</p></li>
<li><p><strong>Cloud clean outdated objects</strong> — Deletes unused data that meets the deletion criteria.</p></li>
<li><p><strong>Cloud clean tokens</strong> — Cleans up tokens that have been expired for more than 24 hours from the database.</p></li>
</ul><h2 id="using-nagios">Using Nagios</h2>

<p>Nagios is used to run the HP Cloud OS Clean-up Utility.</p>

<p>Note: In addition to the Clean-up Utility, other services that reside on the Cloud Controller and Compute Controller 
can be monitored using Nagios.</p>

<ol><li><p>Access the Nagios dashboard (http://192.168.124.10/nagios3/). <strong>Note:</strong> In the current release, the dashboards use pre-defined login credentials. These are not published in the web-hosted documentation. To get the pre-defined login credentials, refer to the readme file included in the same ZIP that contained the HP Cloud OS ISO. 
If you have not already done so, see the ZIP on the <a href="../../../../external.html?link=https://cloudos.hpwsportal.com/" target="codn">HP Helion Distribution Network</a>.</p></li>
<li><p>Click the Services link in the left panel of the Nagios web interface to see the cloud service checks and the other cloud services.</p></li>
</ol><p>In the Nagios dashboard, services and  status information are grouped by node (or "host" in Nagios terminology). 
In the host column, only the admin node is identified by name. All other nodes are identified by their MAC addresses.</p>

<p>To find your alias (or node name) for a given MAC address, go to the Cloud Tab in the Operational Dashboard and click Manage Nodes. 
The Alias and Node ID columns show the name and corresponding MAC address for each node in the cloud.</p>

<h3 id="to-manually-schedule-the-running-of-clean-up-utility-tasks">To manually schedule the running of Clean-up Utility tasks</h3>

<p>As mentioned above, the Clean-up Utility will run automatically every 24 hours. 
No manual scheduling or user intervention is required. But you can manually schedule the Clean-up Utility service to run by 
performing these steps:</p>

<ol><li><p>Choose a node in the host column and click the name of the service you wish to schedule (Cloud clean db objects, Cloud clean deleted objects, Cloud clean outdated objects, or Cloud clean tokens).</p></li>
<li><p>In the Service Commands section, click Re-schedule the next check of this service.</p></li>
<li><p>In the Check Time field, enter the time when you want the service to run.</p></li>
<li><p>Click Commit.</p></li>
<li><p>When the task has completed, the Nagios display is refreshed, showing the date and time that the service was run and the current (updated) status value.</p></li>
</ol><blockquote>
  <p><strong>Note</strong>: Although the Nagios dashboard shows all of the Clean-up Utility services for all nodes, 
  the Cloud clean deleted objects service will always fail if run on a Cloud Controller node. This is expected behavior 
  because that Clean-up Utility service includes tasks that interact with the OpenStack Nova compute service, 
  which is not installed on the Cloud Controller node, but only on Compute Controller nodes.</p>
</blockquote>

<p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Start using HP Cloud<br>
			<a href="../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show" class="signup-button-orange gutter-top-half">Sign Up Now</a>
		</p>
	</aside>
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../index.html"><span>HP Cloud OS Home  (Deprecated)</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../prepare/index.html"><span>Prepare</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../install/index.html"><span>Install</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../index.html"><span>Manage</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../develop/index.html"><span>Develop</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../forum/index.html"><span>Community Forum</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../openstack/index.html"><span>OpenStack Links</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../siteindex/index.html"><span>Site Index</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/cloudos/manage/utilities/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:03:18 GMT -->
</html>

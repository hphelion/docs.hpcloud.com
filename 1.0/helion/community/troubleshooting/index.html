<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/helion/community/troubleshooting/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:04:26 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>HP Helion OpenStack&reg; Community Issues and troubleshooting</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../css/combined.css">

	<script src="../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../index.html" class="logo"  ><img src="../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<script>
<![CDATA[

function PageRefresh {
onLoad="window.refresh"
}

PageRefresh();

]]>
</script><!--
<p style="font-size: small;"> <a href="/helion/community/">&#9664; PREV</a> | <a href="/helion/community/">&#9650; UP</a> | <a href="/helion/community/install-overview/">NEXT &#9654;</a> </p>
--><h1 id="hp-helion-openstack-community-issues-and-troubleshooting">HP Helion OpenStackÂ® Community Issues and troubleshooting</h1>

<p>If you encounter any issues when installing HP Helion OpenStack Community, refer to the following troubleshooting tips.</p>

<ul><li><p>If the overcloud controller is rebooted (power issue, hardware upgrade, etc.), OpenStack compute tools such as <code>nova-list</code> report that the VMs are in an ERROR state, rendering the overcloud unusable. To restore the overcloud to an operational state, follow the steps below:</p>

<ol><li><p>As user root on the overcloud controller you must:</p>

<p>a. Run the os-refresh-config scripts:</p>

<pre><code>os-refresh-config
</code></pre>

<p>b. Restart the mysql service:</p>

<pre><code>service mysql restart
</code></pre>

<p>c. Re-run the os-refresh-config scripts:</p>

<pre><code>os-refresh-config
</code></pre>

<p>d. Restart all neutron services:</p>

<pre><code>service neutron-dhcp-agent restart
service neutron-l3-agent restart
service neutron-metadata-agent restart
service neutron-openvswitch-agent restart
service neutron-server restart
</code></pre></li>
<li><p>On each overcloud node, restart the neutron and nova services:</p>

<pre><code>sudo service neutron-openvswitch-agent restart
sudo service nova-compute restart
sudo service nova-scheduler restart
sudo service nova-conductor restart
</code></pre></li>
</ol></li>
<li><p>On the system on which the installer is run, the seed VM's networking is bridged onto the external LAN. If you remove HP Helion OpenStack Community, the network bridge persists. To revert the network configuration to its pre-installation state, run the following commands as user root:</p>

<pre><code>ip addr add 192.168.185.131/16 dev eth0 scope global
ip addr del 192.168.185.131/16 dev brbm
ovs-vsctl del-port NIC
</code></pre>

<p>where</p>

<ul><li>eth0 is the external interface</li>
<li>192.168.185.131 is the IP address on the external interface - you should replace this with your own IP address.</li>
<li>The baremetal bridge is always called 'brbm'</li>
</ul></li>
</ul><h2 id="known">Known issues and workarounds</h2>

<ul><li><p>The following error has been intermittently observed on HP ProLiant SL390s systems on which installs are being performed:</p>

<pre><code>Fatal PCI Express Device Error PCI Slot ?
B00/D00/F00
</code></pre>

<p>To reset a system that experiences this error,</p>

<ol><li>Connect to the iLO using a web browser (https://<ilo ip="" address="">)</ilo></li>
<li>Navigate to Information / Diagnostics</li>
<li>Reset iLO</li>
<li>Log back into the iLO after 30 seconds</li>
<li>Navigate to Remote Console / Remote Console</li>
<li>Bring up integrated remote console (.NET)</li>
<li>Click Power switch / Press and Hold</li>
<li>Click Power switch / Momentary Press</li>
<li>Wait for system to restart</li>
<li>System should boot normally</li>
</ol></li>
<li><p>The BIOS must be set to the correct date and time on all systems.</p>

<p>On HP ProLiant systems you can do the following:</p>

<ol><li>Power UP the server and configure the BIOS (press F9)</li>
<li>Set Date and Time in the BIOS, and exit confirming your selection.</li>
<li>Power the server off prior to installation</li>
</ol></li>
<li><p>On many HP systems, including HP servers running iLO 3 firmware, the
iLO time can be set to propagate to the BIOS on powerup.
You should disable propagation and set the BIOS time to the correct
date and time on all systems.</p>

<ol><li>Connect to the iLO using a web browser (https://<ilo ip="" address="">)</ilo></li>
<li>Navigate to Network/Shared Network Port or the Network/Dedicated Network Port (Primary Time Server, Secondary Time Server, Time Zone, and Time Propagation settings are shared between all iLO Network Ports).</li>
<li>Navigate to SNTP</li>
<li>UNSET 'Propagate NTP Time to Host'</li>
<li>Reset iLO</li>
<li>Follow the steps above to set the time in the BIOS</li>
</ol></li>
<li><p>If the iLO time propagates to the BIOS, setting an incorrect time,
the undercloud or overcloud may fail to initialize with the following message:</p>

<pre><code>Timing out after 60 seconds:
11:46:38 COMMAND=wait_for_hypervisor_stats 8
</code></pre>

<p>Follow the steps above to set the time in the BIOS correctly.</p></li>
<li><p>The following error has also been observed on the console of a baremetal system during installation when the BIOS date/time are incorrect</p>

<pre><code>/etc/init.d/open-iscsi: 73: /etc/init.d/open-iscsi: cannot create /etc/iscsi/initiatorname.iscsi: Read-only file system
</code></pre>

<p>Follow the steps above to set the time in the BIOS correctly.</p></li>
<li><p>Filesystem checking on reboot is disabled by default for the seed, undercloud and overcloud nodes. We recommend periodically manually running fsck to verify filesystem integrity.</p></li>
<li><p>These files contain credentials for the undercloud and the overcloud; you
should ensure that they are securely stored separately from the seed.</p>

<pre><code>/root/stackrc
/root/tripleo/tripleo_passwords
</code></pre></li>
<li><p>On the seed cloud host (the system on which the installer is run), the seed VM's networking will be bridged onto the external LAN.</p>

<p>To revert this change, reboot the system then execute this command on the console of the host:</p>

<pre><code>ovs-vsctl del-port eth0
</code></pre>

<p>If you specified BRIDGE_INTERFACE as something other than eth0 then replace eth0 in the command above with that value.</p></li>
<li><p>If the <code>hp_ced_host_manager</code> fails to start the seed, execute the command again (a failure could be the result of a race condition in libvirt).</p></li>
<li><p>If the undercloud controller is rebooted, you must login to it and run the following command as root:</p>

<pre><code>os-refresh-config
</code></pre>

<p>Failure to do this will prevent subsequent reboots of the overcloud nodes.</p></li>
<li><p>The installation pauses 1-2 minutes loading images and pauses of 12 or more minutes building the undercloud and overcloud.</p></li>
<li><p>The installer script will wait for os-collect-config to complete on the seed but times out after 10 minutes of waiting.</p></li>
<li><p>The installer uses IPMI commands to reset nodes and change their power status. Some systems have been seen to get into a state where the Server Power status as reported by the iLO stays stuck in the "RESET" state. If this occurs, it is necessary to physically remove power from the server for 10 seconds. If the problem persists after that, contact HP Support - there might be a defective component in the system.</p></li>
<li><p>If using the seed vm as your gateway (default setting), you will need to execute the following commands after you have run <code>hp_ced_host_manager.sh</code> on the host machine.</p>

<pre><code>MAC=$(virsh dumpxml --domain seed | grep "mac address" | head -1 | awk -F "'" '{print $2}')
VM_IP=$(arp -n | grep $MAC | awk '{print $1}')
ip route replace &lt;BM_NETWORK_CIDR&gt; dev virbr0 via $VM_IP
</code></pre></li>
<li><p>The installer now includes an interactive query before running a hardware
census script at the end of the install. This script is optional.</p></li>
<li><p>ElasticSearch indexes are not deleted automatically. Log data will build up over time, potentially filling the space available, unless managed. To see the indexes, ssh to the undercloud node and run:</p>

<pre><code>curl "localhost:9200/_cat/indices?v"
</code></pre>

<p>To remove indexes, run this (you must be on the undercloud node):</p>

<pre><code>curl -XDELETE "localhost:9200/logstash-&lt;DATE&gt;"
</code></pre>

<p>Where <date> is in the format "YYYY.MM.DD" EG "2014.09.09".</date></p>

<p><a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top â </a></p></li>
</ul><hr />
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Start using HP Cloud<br>
			<a href="../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show" class="signup-button-orange gutter-top-half">Sign Up Now</a>
		</p>
	</aside>
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../index.html"><span>HP Helion OpenStack Community Documentation Home</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../release-notes/index.html"><span>Release Notes</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../faq/index.html"><span>FAQ</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../install-overview/index.html"><span>Installation & Configuration</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../related-links/index.html"><span>Related Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../3rd-party-license-agreements/index.html"><span>Open Source and Third-Party Software License Agreements</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../eula/index.html"><span>End User License Agreement</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../siteindex/index.html"><span>Site Index</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/helion/community/troubleshooting/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:04:26 GMT -->
</html>

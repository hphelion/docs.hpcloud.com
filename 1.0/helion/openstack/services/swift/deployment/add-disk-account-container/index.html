<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/helion/openstack/services/swift/deployment/add-disk-account-container/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:59:15 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>HP Helion OpenStack&#174; Add Disk to Account and Container Ring</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../../../../css/combined.css">

	<script src="../../../../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../../../../index.html" class="logo"  ><img src="../../../../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<script>
<![CDATA[

function PageRefresh {
onLoad="window.refresh"
}

PageRefresh();

]]>
</script><!---
<p style="font-size: small;"> <a href=" /helion/openstack/services/object/swift/expand-cluster/">&#9664; PREV</a> | <a href=" /helion/openstack/services/object/swift/expand-cluster/">&#9650; UP</a> | <a href="/helion/openstack/services/swift/deployment/add-disk-scale-out/"> NEXT &#9654</a> </p> ---><h1 id="hp-helion-10-openstack-adding-disks-to-account-or-container-rings">HP Helion 1.0 OpenStack® Adding Disks to Account or Container Rings</h1>

<p>Proxy nodes store account and container objects. When new disks are added to a proxy node, the new disks expand the storage capacity of the account and container rings. We also recommend to use same sets of disks for account and container.</p>

<ol><li><a href="#prer">Prerequisite</a></li>
<li><a href="#adding-swift-disks-to-a-ring">Add Disks to an Account or Container Ring</a></li>
</ol><h2 id="prer">Prerequisite</h2>

<ul><li>HP Helion OpenStack® cloud is successfully deployed.<br /><em>(Starter Swift nodes are functional by default as they are part of cloud deployment.)</em></li>
<li>Scale-out object-ring:1 has been deployed.</li>
<li>At least one Scale-out Proxy node has been deployed.</li>
<li>All of the rings generated <strong>must</strong> be preserved, preferably at more than one location. Swift requires these rings to be consistent across all nodes. </li>
<li>Make a backup of the rings before any operation.</li>
</ul><h2 id="adding-swift-disks-to-a-ring">Add Disks to an Account or Container Ring</h2>

<p>Perform the following steps to add Swift disk to a ring:</p>

<ol><li><p>Log in to the undercloud from seed.</p>

<pre><code># ssh heat-admin@&lt;undercloud IP address&gt; 
# sudo -i
</code></pre></li>
<li><p>Change the directory to ring builder.</p>

<pre><code># cd /root/ring-building
</code></pre></li>
<li><p>List the scale-out proxy node.</p>

<pre><code># ringos list-swift-nodes -t proxy
</code></pre>

<p>The following sample displays the Proxy nodes:</p>

<pre><code>    +---------------+
    | proxy-nodes   |
    +---------------+
    | 192.0.2.22    |
    +---------------+
</code></pre></li>
<li><p>List the disks on the proxy node.</p>

<pre><code># ringos list-disks -n &lt;proxy node IP address&gt; 
</code></pre>

<p>The following sample displays the lists of disk available on the Proxy node <strong>192.0.2.22</strong>.</p>

<pre><code>        +----------+------------+
        | disk     | size       |
        +----------+------------+
        | /dev/sdb | 1073741824 |
        |          |            |
        | /dev/sdc | 1073741824 |
        |          |            |
        +----------+------------+
</code></pre></li>
<li><p>Format the given disk.</p>

<pre><code># ringos format-disks -n &lt;proxy node IP address&gt;  -d &lt;disk&gt;
</code></pre>

<p>The following sample displays the output of formatted disk of <strong>192.0.2.22</strong>.</p>

<pre><code>+----------+-----------+---------+---------------------------------+-------------+------------+
| disk     | formatted | mounted | mount_point                     | label       | size       |
+----------+-----------+---------+---------------------------------+-------------+------------+
| /dev/sdb | y         | y       | /mnt/state/srv/node/b1410063336 | b1410063336 | 1073741824 |
+----------+-----------+---------+---------------------------------+-------------+------------+
</code></pre>

<p><strong>Note</strong>: You can format all the disks with a single command (-d --all).</p></li>
<li><p>List the file in the ring building directory. Identify <code>account.builder</code> and <code>container.builder</code> files.</p></li>
<li><p>(Optional)If the builder file does not exit in the undercloud, copy the builder files using the following command.</p>

<pre><code>rsync -qzp --rsync-path="sudo rsync" heat-admin@&lt;starter Swift nodes IP address&gt;:/etc/swift/account.builder /root/ring-building/
rsync -qzp --rsync-path="sudo rsync" heat-admin@&lt;starter Swift nodes IP address&gt;:/etc/swift/container.builder /root/ring-building/
</code></pre></li>
<li><p>Add the formatted disk to account and container ring(s).</p>

<pre><code># ringos add-disk-to-ring -f /root/ring-building/account.builder -i &lt;Proxy nodes IP address&gt; -p &lt;port&gt; -d &lt;disk label&gt; -w &lt;weight&gt; -r &lt;region&gt; -z &lt;zone&gt;
# ringos add-disk-to-ring -f /root/ring-building/container.builder -i &lt;Proxy nodes IP address&gt; -p &lt;port&gt; -d &lt;disk label&gt; -w &lt;weight&gt; -r &lt;region&gt; -z &lt;zone&gt;
</code></pre>

<p><strong>Note</strong>:</p>

<ul><li>Choose the zone and region information appropriately.</li>
<li>The disk label is derived from step 5.</li>
<li>The port for the container ring is <code>6001</code> and account ring is <code>6002</code>.</li>
</ul><p><strong>Recommendation</strong>:</p>

<ul><li>Add drives gradually using a weighted approach to avoid degraded performance of Swift cluster. The weight will gradually increase by 25% until it becomes 100%. The initial weight is 25.</li>
</ul></li>
<li><p>Re-balance both account and container ring(s).</p>

<pre><code># ringos rebalance-ring -f /root/ring-building/account.builder
# ringos rebalance-ring -f /root/ring-building/container.builder    
</code></pre></li>
<li><p>List all the Swift nodes.</p>

<pre><code># ringos list-swift-nodes -t all
</code></pre></li>
<li><p>Copy <code>account.ring.gz</code>  and  <code>container.ring.gz</code> files to all the nodes.</p>

<pre><code># ringos copy-ring -s /root/ring-building/account.ring.gz -n &lt;Swift nodes IP address&gt;
# ringos copy-ring -s /root/ring-building/container.ring.gz -n &lt;Swift nodes IP address&gt;
</code></pre></li>
<li><p>Set the weight of the disks using the following command:</p>

<pre><code># ringos set-weight -f /root/ring-building/account.builder -s &lt;disk id&gt; -w &lt;weight&gt;
# ringos set-weight -f /root/ring-building/container.builder -s &lt;disk id&gt; -w &lt;weight&gt;
</code></pre></li>
<li><p>Repeat steps from <strong>8-11</strong> increasing the weight by 25 each time; set the weight to 50, 75, and finally 100 (w= 50, 75, 100) .</p></li>
</ol><p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<hr />
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Start using HP Cloud<br>
			<a href="../../../../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show" class="signup-button-orange gutter-top-half">Sign Up Now</a>
		</p>
	</aside>
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../index.html"><span>HP Helion OpenStack Documentation Home</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../release-notes/101/index.html"><span>Release Notes</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../faq/index.html"><span>FAQ</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../technical-overview/index.html"><span>Technical Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../overview/index.html"><span>Services Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../support-matrix/index.html"><span>Support Matrix</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../install/overview/index.html"><span>Installation Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../install/security/index.html"><span>Network Security</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../backup.restore/index.html"><span>Back Up and Restore</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../troubleshooting/index.html"><span>Troubleshooting</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../related-links/index.html"><span>Related Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../glossary/index.html"><span>Glossary</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../eula/index.html"><span>End User License Agreement</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../3rd-party-license-agreements/index.html"><span>Open Source and Third-Party Software License Agreements</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../siteindex/index.html"><span>Site Index</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/helion/openstack/services/swift/deployment/add-disk-account-container/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:59:15 GMT -->
</html>

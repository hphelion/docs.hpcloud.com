<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/helion/openstack/update/prereqs/101/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:58:28 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>HP Helion OpenStack&#174; Update Prerequisites</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../../../css/combined.css">

	<script src="../../../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../../../index.html" class="logo"  ><img src="../../../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<script>
<![CDATA[

function PageRefresh {
onLoad="window.refresh"
}

PageRefresh();

]]>
</script><!--
<p style="font-size: small;"> <a href="/helion/openstack/">&#9664; PREV | <a href="/helion/openstack/">&#9650; UP</a> | <a href="/helion/openstack/faq/">NEXT &#9654; </a></p>
--><h1 id="hp-helion-openstack-10-update-prerequisites">HP Helion OpenStack® 1.0 Update Prerequisites</h1>

<p>Prior to getting a system ready for update and performing the update, there might be a few tasks that you need to complete that could affect the update outcome.  Read this document for information about:</p>

<ul><li><a href="#check">Performing a System check</a></li>
<li><a href="#info">Gathering information needed for update</a></li>
</ul><h3 id="check">Perform a system check</h3>

<ol><li><p>If you have changed your admin password for undercloud you need to make sure you update the files below, if you have not already done so.</p>

<p>If you do not update the password in configuration files, the update will fail.</p>

<p>If you have not changed your undercloud admin password you can skip this task.</p>

<p>a. Edit the seed cloud host root directory. In the <code>/root/tripleo/tripleo-undercloud-passwords</code> file, modify the <code>UNDER_CLOUD_ADMIN_PASSWORD</code> value.</p>

<p>b. Edit file environment variables JSON file. In the <code>/root/tripleo/ce_env.json</code> file, update the undercloud <code>"password":</code> line with the new password. for example:</p>

<pre><code>"undercloud": {
    "password": "65eef816ac721d6f1b870dfaaff0e7a781dfbc04",
</code></pre>

<p>c.  Edit the <code>stackrc</code> file on the undercloud to contain the new password. Use SSH to access the undercloud, edit the OS_PASSWORD variable in the <code>stackrc</code> file and save the change.</p>

<pre><code>ssh heat-admin@&lt;undercloudIP&gt;
sudo -i
</code></pre></li>
<li><p>Prior to starting update you need to verify you are running Ubuntu that is greater than 3.13.0-36 on your seed cloud host machine.</p>

<p>Verifying and obtaining the correct kernel may vary depending on distribution.  From a command prompt seed cloud host run the following command to verify the operating system and current version:</p>

<pre><code>uname -r   
</code></pre>

<p>Follow instructions for your Linux distribution to update.</p></li>
</ol><!---removing as per JIRA 
### Extract the required scripts and libraries ### {#extract}

As mentioned in the [Update Overview](/helion/openstack/update/overview/101/), a HP Helion OpenStack patch update is composed of multiple major components.  

The Overcloud node images can be one of the components. If you have [downloaded the patch update using Sherpa](/helion/openstack/update/download/101/), at this stage the overcloud node images are located in the undercloud image repository. 

The other files come as TAR files and are delivered to the undercloud local filesystem, by default, the `/tmp/heat_templates` folder.  It is possible to change the location of the undercloud patch update tarballs, during or after deployment. See [Change the default](#default) below. 

To extract the files:

1. Use SSH to access the seed cloud host:

        ssh heat-admin@<seed_cloud_host_IP>
        sudo -i

2. Copy the TAR file to the seed cloud host and extract contents. From an SSH session to the seed cloud host do the following:

        ssh heat-admin@<undercloudIP>
        sudo -i

        scp heat-admin@<Insert undercloudIP>:/tmp/heat_templates/* /tmp
        tar xvf tripleo-ansible<version>.tar 
        mv /opt/stack/tripleo-ansible /opt/stack/tripleo-ansible-orig
        mv /tmp/tripleo-ansible /opt/stack/

    Where:

    * <Insert undercloudIP> is the IP of the undercloud node
    * /tmp/heat_templates/ is the default location of the TAR files; enter the appropriate location, if you [changed the location](#default).

    The files will now be extracted in the seed tmp node.  If desired, you can delete the files in the `/tmp/heat_templates` directory.

#### Change the default #### {#default}

It is possible to change the location of the undercloud patch update TAR files, during or after deployment. The default location is the `/tmp/heat_templates` folder.   

If you have done so you can recall where you have changed the directory to by viewing the Sherpa configuration file.  

The Sherpa configuration file for the undercloud can be found at `/etc/sherpa/sherpa.conf`. 

The directory where the files where stored can be found by looking in the `RepositoryMgr` portion of `/etc/sherpa/sherpa.conf`. Search for the directory attribute as seen below:

    'file': {
    'classname': 'sherpa.handlers.repository.file.FileSystemHandler',
    'destinations': [
    {
    'directory': '/tmp/heat_templates',

When locating the update files, use the directory set in `/etc/sherpa/sherpa.conf`.

----><h2 id="info">Gather information needed for update</h2>

<p>To perform a node-by-node or group-by-group update, you will need the IPs of the nodes you are updating and the image IDs of the new images to place on the nodes.</p>

<p>During the update, you might be asked for various IPs and image ID's, when you are refer to this section or save off the information and use it where required.</p>

<h3 id="determine">Determine IP of nodes</h3>

<p>The administrator should know the IP address of the seed cloud host node.  Other IP address can be obtained using the commands below.  Please record these for later use.</p>

<p>
  <strong>Undercloud IP</strong>
</p>

<p>To obtain the IP addresses of the undercloud nodes, run the following commands:</p>

<ol><li><p>Log in the seed cloud host.</p>

<pre><code>sudo su -
</code></pre></li>
<li><p>SSH to the seed VM.</p>

<pre><code>ssh root@192.0.2.1 
</code></pre></li>
<li><p>Point the <code>stackrc</code> file at the undercloud:</p>

<pre><code>source ./stackrc
</code></pre>

<p><strong>Note:</strong> This command is described in <a href="../../undercloud/101/index.html">Updating the Undercloud</a>.</p></li>
<li><p>Run the following command:</p>

<pre><code>nova list
</code></pre></li>
</ol><p>The IP addresses of the Undercloud will be listed in the <code>nova list</code> results.</p>

<p>
  <strong>Undercloud Image ID</strong>
</p>

<p>To determine image ID of the undercloud nodes:</p>

<ol><li><p>Log in the seed cloud host.</p>

<pre><code>sudo su -
</code></pre></li>
<li><p>SSH to the seed VM.</p>

<pre><code>ssh root@192.0.2.1 
</code></pre></li>
<li><p>Point the <code>stackrc</code> file at the undercloud:</p>

<pre><code>source ./stackrc
</code></pre>

<p><strong>Note:</strong> This command is described in <a href="../../undercloud/101/index.html">Updating the Undercloud</a>.</p></li>
<li><p>Run the following command:</p>

<pre><code>glance image-list | grep qcow2
</code></pre>

<p>The output appears silimar to the following:</p>

<p><img src="../../../../../content/documentation/media/Update_UC_Image_ID.png" /></p>

<p>The ID is to the left of the image name you are looking for. For exaple, the undercloud main image is <code>undercloud</code> and it has image id <code>94763220-a2f1-edfd686</code>.</p></li>
</ol><p>
  <strong>Overcloud IP</strong>
</p>

<p>To obtain the IP addresses of the overcloud nodes, perform the following:</p>

<ol><li><p>Log in the seed cloud host.</p>

<pre><code>sudo su -
</code></pre></li>
<li><p>SSH to the seed VM.</p>

<pre><code>ssh root@192.0.2.1 
</code></pre></li>
<li><p>SSH into the Undercloud then become root and source the stackrc file:</p>

<pre><code>ssh heat-admin@&lt;Undercloud IP&gt;
sudo -i
source ./stackrc
</code></pre>

<p><strong>Note:</strong> This command is described in <a href="../../overcloud/101/index.html">Updating the Overcloud</a>.</p>

<pre><code>nova list | awk -F"|" '{gsub(/ctlplane=/,"",$7); print $3,$7;}'
</code></pre>

<p>The output appears silimar to the following (node names and full IP addresses have been removed for this image):</p>

<p><img src="../../../../../content/documentation/media/Update_OC_IP.png" /></p></li>
</ol><p>
  <strong>Overcloud Image ID</strong>
</p>

<ol><li><p>Log in the seed cloud host:</p>

<pre><code>sudo su -
</code></pre></li>
<li><p>SSH to the seed VM:</p>

<pre><code>ssh root@192.0.2.1 
</code></pre></li>
<li><p>SSH into the undercloud then become root and source the stackrc file:</p>

<pre><code>ssh heat-admin@&lt;Undercloud IP&gt;
sudo -i
source ./stackrc
</code></pre></li>
<li><p>Execute following command:</p>

<p>glance image-list | grep qcow2</p>

<p>The output appears silimar to the following (the full iamge IDs have been removed for this image):</p>

<p><img src="../../../../../content/documentation/media/Update_OC_Image_ID.png" /></p>

<p>The ID is to the left of the image name you are looking for.  For example, the <code>controllerMgmt</code> main image is <code>overcloud-control-mgmt</code> and it has image id <code>8b015088-edf1-4a8c-a798</code></p></li>
</ol><h2 id="next-steps">Next Steps</h2>

<p>Update the seed VM.</p>

<p>For information, see <a href="../../seed/101/index.html">Updating the Seed VM</a>.</p>

<p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<hr />
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Start using HP Cloud<br>
			<a href="../../../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show" class="signup-button-orange gutter-top-half">Sign Up Now</a>
		</p>
	</aside>
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../index.html"><span>HP Helion OpenStack Documentation Home</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../release-notes/101/index.html"><span>Release Notes</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../faq/index.html"><span>FAQ</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../technical-overview/index.html"><span>Technical Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../services/overview/index.html"><span>Services Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../support-matrix/index.html"><span>Support Matrix</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../install/overview/index.html"><span>Installation Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../install/security/index.html"><span>Network Security</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../backup.restore/index.html"><span>Back Up and Restore</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../services/troubleshooting/index.html"><span>Troubleshooting</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../related-links/index.html"><span>Related Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../glossary/index.html"><span>Glossary</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../eula/index.html"><span>End User License Agreement</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../3rd-party-license-agreements/index.html"><span>Open Source and Third-Party Software License Agreements</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../siteindex/index.html"><span>Site Index</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/helion/openstack/update/prereqs/101/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:58:28 GMT -->
</html>

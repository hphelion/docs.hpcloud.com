<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/helion/openstack/backup.restore/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:52:24 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>HP Helion OpenStack&#174; Edition: Back Up and Restore</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../css/combined.css">

	<script src="../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../index.html" class="logo"  ><img src="../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<script>
<![CDATA[

function PageRefresh {
onLoad="window.refresh"
}

PageRefresh();

]]>
</script><!--
<p style="font-size: small;"> <a href="/helion/openstack/install/kvm/">&#9664; PREV</a> | <a href="/helion/openstack/install-overview/">&#9650; UP</a> | <a href="/helion/openstack/install/esx/">NEXT &#9654;</a> </p>
--><h1 id="hp-helion-openstack-back-up-and-restore">HP Helion OpenStack® Back Up and Restore</h1>

<p>The default HP Helion OpenStack environment consists of a three-node cluster for most of the services plus other services such as RabbitMQ and MySQL. It is resilient to individual node failures as well as network split-brain situations.</p>

<p>However, as part of your maintenance of the environment, you should create a back up of each component and be prepared to restore any component, should it become necessary.</p>

<ul><li><p><strong>Undercloud.</strong> The undercloud is a critical component that runs the centralized Logging, Monitoring, and Orchestration engines for deployment and automated configuration of the overcloud. It also provides a DHCP Server for all nodes of the overcloud.</p>

<p>If the undercloud server fails, it must be rebuilt and restored as soon as possible.</p></li>
<li><p><strong>Overcloud.</strong> The overcloud includes two overcloud controllers and one overcloud management controller.</p>

<p>If either of the servers that host the two overcloud controllers fails, the overcloud controller must be rebuilt and reconnected into the cluster as soon as possible.</p>

<p>The management controller is similar to the overcloud controller nodes, but it also executes various additional services, including Compute, Sherpa, Telemetry, Reporting, and Block Storage services. If the server that hosts the overcloud management controller fails, the management controller must be rebuilt and restored as soon as possible.</p></li>
<li><p><strong>Overcloud database</strong> The MySQL database or entire cluster on the overcloud Controllers may become corrupted. To prevent data loss, you will need back up and restore capability for the databases.</p></li>
</ul><p>The following instructions describe how to back up and restore the seed VM, undercloud, and overcloud:</p>

<ul><li><a href="#config">Create a configuration file for restoring the seed VM and undercloud</a></li>
<li><a href="#seed">Back up and restore the seed VM</a></li>
<li><a href="#under">Back up and restore the undercloud</a></li>
<li><a href="#over">Back up and restore the overcloud</a></li>
<li><a href="#options">Backup command options</a></li>
<li><a href="#roptions">Restore command options</a></li>
<li><a href="#underpass">Undercloud password issues</a></li>
</ul><p>Note that the seed cloud host server is where the seed VM is installed and the installation files are located.</p>

<p>If you need help, see <a href="#help">Back up and Restore Script Help</a>.</p>

<h2 id="config">Create a configuration file for restoring the seed VM and undercloud</h2>

<p>During restore process for the seed VM and undercloud, a configuration file is required. The configuration file contains exported parameters used during the installation.</p>

<p>Use the following steps to back up the seed VM:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Create a configuration file that contains all of the following information:</p>

<pre><code>export BRIDGE_INTERFACE=&lt;interface&gt;
export OVERCLOUD_NTP_SERVER=&lt;ntp.server.ip&gt;
export UNDERCLOUD_NTP_SERVER=&lt;ntp.server.ip&gt;
export OVERCLOUD_CODN_HTTP_PROXY=http://&lt;proxy.server.ip&gt;
export OVERCLOUD_CODN_HTTPS_PROXY=http://&lt;proxy.server.ip&gt;
export UNDERCLOUD_CODN_HTTP_PROXY=http://&lt;proxy.server.ip&gt;
export UNDERCLOUD_CODN_HTTPS_PROXY=http://&lt;proxy.server.ip&gt;
</code></pre>

<p>Where:</p>

<pre><code>- BRIDGE_INTERFACE is the name of the device connected to the private network that connects all baremetal nodes. By default `eth0`.
- OVERCLOUD_NTP_SERVER is the IP address of the NTP server for the overcloud.
- UNDERCLOUD_NTP_SERVER is the IP address of the NTP server for the undercloud.
- OVERCLOUD_CODN_HTTP_PROXY is the
- OVERCLOUD_CODN_HTTPS_PROXY is the
- UNDERCLOUD_CODN_HTTP_PROXY is the
- UNDERCLOUD_CODN_HTTPS_PROXY is the
</code></pre></li>
</ol><h2 id="seed">Back up and restore the seed VM</h2>

<p>The following sections describe how and when to <a href="#backseed">back up</a> and <a href="#seedrest">restore</a> the seed VM.</p>

<h3 id="seedback">Backing up the seed VM</h3>

<p>You should create a backup from the seed VM when any of the following events happen:</p>

<ul><li>When the installation process is complete.</li>
<li>When any change is make in the undercloud from the seed cloud host</li>
<li>When the undercloud restore process is performed (a new seed VM is created)</li>
</ul><p>Use the following steps to back up the seed VM:</p>

<ol><li><p>Log in to the seed VM host.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory.</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_backup.sh --seed -f /root/backup
</code></pre>

<p>A message similar to the following displays:</p>

<pre><code>HP Helion Community Edition Version Backup Procedure

Destination Host Folder: /root/backup/
Starting backup procedure for Seed...
Backup files stored at /root/backup/backup_14-09-02-15-25/seed
Backup spec file now
Backup seed.qcow2 now
Backup ssh keys now
Backup Seed Finished.
Backup Procedure Completed
</code></pre></li>
</ol><p>All required files are backed-up to the specified folder:
    <code>/&lt;destination folder&gt;/backup_YY-MM-DD-HH-MM/seed</code></p>

<h3 id="seedrest">Restoring the seed VM</h3>

<p>You should restore the seed VM when there is any problem with the node, for example:</p>

<ul><li>If the server where the VM is located fails (from a hardware or software issue).</li>
<li>If there is any problem with the VM.</li>
<li>If there is any problem in the operating system level.</li>
<li>If there is any problem with the installation that cannot be corrected.</li>
</ul><p>
  <strong>Important: During the restore process the original seed VM will be deleted from the server.</strong>
</p>

<p>Use the following steps to restore the seed VM:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Create a <a href="#config">configuration file</a> with all the parameters exported during the installation of the seed VM (for example: /root/export.prop).</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory.</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_restore.sh --seed -f &lt;location of the backup files&gt; -c /root/export.prop
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Restore Seed Finished.
Restore Procedure Completed
</code></pre>

<p><strong>Example</strong></p>

<pre><code>root@kvmhost:~/tripleo/tripleo-incubator/scripts# ./hp_ced_restore.sh --seed -f /root/backup/backup_14-09-02-12-32 -c /root/export.prop

HP Helion Community Edition Version Restore Procedure

Source Host Folder: /root/backup/backup_14-09-02-12-32
Backup from local host. Local Backup Folder is set to: /root/backup/backup_14-09-02-12-32
Starting restore procedure for Seed...
Restore spec file from /root/backup/backup_14-09-02-12-32/seed
...
...
Seed VM created with MAC AB:CD:EF:GH:IJ:LM
...
...
Wait for seed up
...
...
Restore seed finished.
Restore procedure completed
</code></pre></li>
</ol><p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<h2 id="under">Back up and restore the undercloud</h2>

<p>The following sections describe how and when to <a href="#underback">back up</a> and <a href="#underrest">restore</a> the undercloud.</p>

<h3 id="underback">Backing up the undercloud</h3>

<p>You should create a backup from undercloud as soon as the overcloud is deployed and configured the first time.</p>

<p>Also you should create a backup when any change is made in the overcloud from the undercloud server.</p>

<p>
  <strong>Important: During the backup process the undercloud server will be unavailable.</strong>
</p>

<p>Use the following steps to back up the undercloud:</p>

<p>1.Log in to the seed cloud host.</p>

<ol><li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory:</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>`./hp_ced_backup.sh --undercloud -f &lt;destination folder&gt;`
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Backup undercloud finished.
Backup procedure completed.
</code></pre></li>
</ol><p>
  <strong>Example</strong>
</p>

<pre>
  <code>    root@kvmhost:~/tripleo/tripleo-incubator/scripts# ./hp_ced_backup.sh --undercloud -f /root/backup/

    HP Helion Community Edition Version (unknown) Backup Procedure

    Destination Host Folder: /root/backup/
    Starting of Backup procedure for undercloud...
    The backup will be written to /root/backup//backup_14-09-03-12-17
    Temporary folder: /tmp/backup_14-09-03-12-17
    Backing up seed Files...
    ...
    ...
    Deleting temporary undercloud backup files...
    Warning: Permanently added '192.0.2.2' (ECDSA) to the list of known hosts.
    Backup undercloud finished.
    Backup procedure completed.
</code>
</pre>

<p>All required files are backed up to the specified folder:</p>

<pre>
  <code>/&lt;destination folder&gt;/backup_YY-MM-DD-HH-MM/uc
</code>
</pre>

<h3 id="underrest">Restoring the undercloud</h3>

<p>You should restore the undercloud when there is any problem with the node, for example:</p>

<ul><li>If the server where the node was located fails (from a hardware or software issue)</li>
<li>If there is any problem in the OS level</li>
<li>If there is any problem with the installation that cannot be corrected</li>
</ul><p>
  <strong>Important:</strong>
</p>

<ul><li>During the restore of the undercloud, the seed VM will be deployed again. You should <a href="#seedback">create a new backup from seed</a> after the undercloud is restored.</li>
<li>If the resource files are stored locally, the source files must be located in the <code>/tmp/</code> directory.</li>
<li>If the admin user password was changed from the original password created during the installation process, see <a href="#underpass">undercloud password issues</a> before beginning the restore.</li>
</ul><p>Use the following steps to restore the undercloud:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Create a <a href="#config">configuration file</a> with all the parameters that was exported during before the installation of the undercloud node.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory:</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Create a file called <code>baremetal.csv</code> and save to the same location where the backup and restore scripts are located.</p>

<p><strong>Example</strong></p>

<pre><code>/root/tripleo/tripleo-incubator/scripts
</code></pre></li>
<li><p>Edit the <code>baremental.csv</code> file to include only the line from your initial baremetal installation for your undercloud node. This is the first line in the initial <code>baremetal.csv</code> file.</p>

<p><strong>Example</strong></p>

<pre><code> 78:e7:d1:22:5d:58,administrator,password,192.168.11.1,12,32768,1900
</code></pre>

<p>For more information on the <code>baremetal.csv</code> file, see the <a href="../install/prereqs.html#csv">Installation Prerequisites</a>.</p></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_restore.sh --undercloud -f &lt;source folder&gt; -c &lt;config file&gt;
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>"Restore undercloud finished."
"Restore procedure completed"
</code></pre></li>
</ol><p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<h2 id="over">Back up and restore the overcloud</h2>

<p>The following sections describe how and when to back up and restore the overcloud.</p>

<p>You can <a href="#sherpaback">back up</a> and <a href="#sherparest">restore</a> an overcloud server or <a href="#databack">back up</a> and <a href="#datarest">restore</a> the overcloud database.</p>

<h3 id="sherpaback">Backing up an overcloud server</h3>

<p>You should create a backup of the overcloud servers when any Update and Extension is download to the system.</p>

<p>Use the following steps to back up the overcloud:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory:</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_backup.sh --overcloud -f &lt;destination folder&gt;
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Backup overcloud finished.
Backup procedure completed
</code></pre>

<p><strong>Example</strong></p>

<pre><code>./hp_ced_backup.sh --overcloud -f /root/backup/

HP Helion Community Edition Version Backup Procedure

Destination Host Folder: /root/backup/
Starting of Backup procedure for overcloud...
The backup will be written to /root/backup/backup_14-09-03-12-30
...
...
Deleting temporary overcloud backup files...
Backup overcloud finished.
Backup procedure completed
</code></pre></li>
</ol><p>All required files are backed-up to the specified folder:</p>

<pre>
  <code>/&lt;destination folder&gt;/backup_YY-MM-DD-HH-MM/oc
</code>
</pre>

<h3 id="sherparest">Restoring the Sherpa overcloud</h3>

<p>Use the following steps to restore the Sherpa overcloud:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory:</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_restore.sh --overcloud -f &lt;location of the backup files&gt;
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Restore overcloud finished.
Restore procedure completed
</code></pre>

<p><strong>Example</strong></p>

<pre><code>./hp_ced_restore.sh --overcloud -f /root/backup/backup_14-09-03-12-30

HP Helion Community Edition Version Restore Procedure

Source Host Folder: /root/backup/backup_14-09-03-12-30
Backup from local host. Local Backup Folder is set to: /root/backup/backup_14-09-03-12-30
Starting restore procedure for overcloud...
Restore source folder: /root/backup/backup_14-09-03-12-30
Restore name: backup_14-09-03-12-30
...
...
Restore overcloud finished.
Restore procedure completed
</code></pre></li>
</ol><p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<h3 id="sherpaback">Backing up the overcloud database</h3>

<p>You should create a backup from the overcloud database on a regular basis as determined by the administrator or your organization's policies.</p>

<p>Use the following steps to back up the overcloud database:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory:</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_backup.sh --database -f &lt;destination folder&gt;
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Backup overcloud database finished.
Backup procedure completed
</code></pre>

<p><strong>Example</strong></p>

<pre><code>./hp_ced_backup.sh --database -f /root/backup/

HP Helion Community Edition Version Backup Procedure

Destination Host Folder: /root/backup/
Starting of Backup procedure for overcloud database...
The backup will be written to /root/backup/backup_14-09-03-12-46 temporary folder /tmp/backup_14-09-03-12-46
...
...
Deleting temporary overcloud database backup files...
Backup overcloud database finished.
Backup procedure completed
</code></pre></li>
</ol><p>All required files are backed-up to the specified folder:</p>

<pre>
  <code>    /&lt;destination folder&gt;/backup_YY-MM-DD-HH-MM/db
</code>
</pre>

<h3 id="sherparest">Restoring the overcloud database</h3>

<p>You should restore the overcloud database when there is any problem with the node, for example:</p>

<ul><li>If the overcloud server fails (from a hardware or software issues)</li>
<li>If the database becomes corrupted for any reason</li>
<li>If an old database needs to be recovered for any reason</li>
</ul><p>
  <strong>Important:</strong>
</p>

<ul><li>During the backup process of the overcloud database the server won't be affected.</li>
<li>Every time that the overcloud database restore procedure is executed a backup of the current database will be created inside each node and will be located at <code>/mnt/state/var/lib/mysql_YY-MM-DD-HH-MM</code>.</li>
<li>If any problem happens during the restore, the operator can go and manually bring the MySQL cluster back and execute <code>os-refresh-config</code> in all the nodes</li>
</ul><p>Use the following steps to restore the overcloud database:</p>

<ol><li><p>Log in to the seed cloud host.</p></li>
<li><p>Change to the <code>/root/tripleo/tripleo-incubator/scripts/</code> directory.</p>

<pre><code>cd /root/tripleo/tripleo-incubator/scripts/
</code></pre></li>
<li><p>Execute the following script:</p>

<pre><code>./hp_ced_restore.sh --overcloud -f &lt;location of the backup files&gt;
</code></pre>

<p>When the process is complete, a message similar to the following displays:</p>

<pre><code>Restore overcloud database finished.
Restore procedure completed
</code></pre>

<p><strong>Example</strong></p>

<pre><code>./hp_ced_restore.sh --database -f /root/backup/backup_14-09-03-12-46

HP Helion Community Edition Version Restore Procedure

Source Host Folder: /root/backup/backup_14-09-03-12-46
Backup from local host. Local Backup Folder is set to: /root/backup/backup_14-09-03-12-46
Starting restore procedure for overcloud database...
...
...
INFO:os-refresh-config:Completed phase migration
Restore Procedure Completed
</code></pre></li>
</ol><p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<!--
### Rebuilding the Overcloud Management Controller ### {#mgmt}

If the overcloud management controller goes down for a period of time or fails, you need to rebuild the overcloud management controller and any Volume Operation (Cinder) storage volume that were affected. 

During the period that the server is re-building, you can temporarily restart the storage volumes using the following steps:

1.  SSH to the undercloud controllers.

2. Execute the following commands

        os-svc-enable-upstart cinder-volume enable
        service cinder-volume start

After the management controller is rebuilt, use the following steps below to disable the temporary solution:

1. SSH to the same undercloud controllers where cinder-volume was enable before

2. Execute the following commands

        service cinder-volume stop
        os-svc-enable-upstart cinder-volume disable

**Important:** After manually enabling and starting the storage volumes on controller0 or controller1, if you run the `os-refresh-config` command, the Volume Operations service stops and is disabled again. You must make sure that you enables the service again.
-->

<h2 id="help">Back up and restore help</h2>

<p>Use the following sections as needed.</p>

<h3 id="options">Backup command options</h3>

<p>The following lists all of the command options for the backup script, <code>hp_ced_backup.sh</code>.</p>

<pre>
  <code>    root@kvmhost:~/tripleo/tripleo-incubator/scripts# ./hp_ced_backup.sh --help
    HP Helion Community Edition Version Backup Procedure
    Usage: hp_ced_backup.sh [options]
    The Backup tool can back up the following:
        1. seed
        2. undercloud
        3. overcloud
        4. overcloud Database

    Options:
        [Required]
        -S|--seed       - backups seed
        -U|--undercloud     - backups undercloud
        -O|--overcloud      - backups overcloud
        -D|--database       - backups overcloud database
        -f|--dest-host-folder   - folder path to which to backup
        [Optional]
        -H|--dest-host-ip       - ip of host to which to backup
        -u|--dest-host-user     - username of host to which to backup
        -i|--identity-file      - selects a file from which the identity (private key) for public key authentication is read
</code>
</pre>

<h3 id="roptions">Restore command options</h3>

<p>The following lists all of the command options for the backup script, <code>hp_ced_restore.sh</code>.</p>

<pre>
  <code>    root@kvmhost:~/tripleo/tripleo-incubator/scripts# ./hp_ced_restore.sh --help

    HP Helion Community Edition Version Restore Procedure

    Usage: hp_ced_restore.sh [options]

    The Restore tool can restore the following from a previous restore
        1. seed
        2. undercloud
        3. overcloud
        4. overcloud Database

    Options:
    [Required]
        -S|--seed       - restores seed
        -U|--undercloud     - restores undercloud
        -O|--overcloud      - restores overcloud
        -D|--database       - restores overcloud database
        -f|--source-host-folder     - folder path from which to restore
    [Optional]
        -H|--source-host-ip     - ip of host from which to restore
        -u|--source-host-user   - username of host from which to restore
        -i|--identity-file      - selects a file from which the identity (private key) for public key authentication is read
        -c|--config-file        - Installer will source this config file on the host (and on the seed in case undercloud is being restored)
</code>
</pre>

<p>Other optional options that can be used during the backup/restore process, as:</p>

<ul><li>Backup/Restore the files in/from a remote server (using option H)</li>
<li>Backup seed + undercloud + ... all at once using all the parameters at the same time (--seed, --undercloud --overcloud)</li>
</ul><h2 id="underpass">Undercloud password issues</h2>

<p>If the admin user password was changed from the original password created during the installation process, you need to update the password in some files before performing the undercloud backup or restore process. If this process has been done and the files contain the correct password, you do not need to edit the files.</p>

<ol><li>Log in to the seed cloud host.</li>
<li>SSH to the seed VM</li>
<li>Open the <code>/root/tripleo/tripleo-undercloud-passwords</code> file.</li>
<li>Update the <code>UNDERCLOUD_ADMIN_PASSWORD=</code> line with the new password and save the file.</li>
<li>Open the file <code>/root/tripleo/ce_env.json</code>. </li>
<li>Update the <code>undercloud</code> line with the new password and save the file.</li>
<li>SSH to the undercloud server.</li>
<li>Open the <code>/root/stackrc</code> file.</li>
<li>Update the <code>OS_PASSWORD=</code> line with the new password and save the file.</li>
</ol><h2 id="for-more-information">For more information</h2>

<p>For information on Disaster Recovery (DR) and Business Continuity Planning (BCP) plans, see <a href="../disaster/recovery/index.html">Disaster Recovery</a>.</p>

<p>
  <a href="#top" style="padding:14px 0px 14px 0px; text-decoration: none;"> Return to Top ↑ </a>
</p>

<hr />
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Start using HP Cloud<br>
			<a href="../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show" class="signup-button-orange gutter-top-half">Sign Up Now</a>
		</p>
	</aside>
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../index.html"><span>HP Helion OpenStack Documentation Home</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../release-notes/101/index.html"><span>Release Notes</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../faq/index.html"><span>FAQ</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../technical-overview/index.html"><span>Technical Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../services/overview/index.html"><span>Services Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../support-matrix/index.html"><span>Support Matrix</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../install/overview/index.html"><span>Installation Overview</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../install/security/index.html"><span>Network Security</span></a>
      </li>
    
      
      
        
      
      <li>
        <a class="highlighted" href="index.html"><span>Back Up and Restore</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../services/troubleshooting/index.html"><span>Troubleshooting</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../related-links/index.html"><span>Related Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../glossary/index.html"><span>Glossary</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../eula/index.html"><span>End User License Agreement</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../3rd-party-license-agreements/index.html"><span>Open Source and Third-Party Software License Agreements</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../siteindex/index.html"><span>Site Index</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/helion/openstack/backup.restore/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 14:52:24 GMT -->
</html>

<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<!-- Mirrored from docs.hpcloud.com/als/v1/user/services/port-service/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:04:26 GMT -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Port Service (Harbor)</title>
	
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="shortcut icon" href="../../../../../favicon.ico" type="image/vnd.microsoft.icon" />
  <link rel="stylesheet" href="../../../../../css/combined.css">

	<script src="../../../../../js/modernizr-2.5.3.min.js"></script>
	<script src="../../../../../js/metrics.js"></script> 
</head>
<body>
  <div id="wrapper">
    <!--[if lt IE 7]>
    	<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->
    <div class="header-container">
      <header class="header">
      	<div class="top-bar" style="height: 75px;">
		
      		<div class="search-wrapper wrapper container_16">
			
      			<a href="#" class="sales-rep show-320 show-480 hide-768"><span aria-hidden="true" class="icon-icon-sales-rep"></span></a>
      			<nav class="sub-nav" >
				<a href="../../../../../index.html" class="logo"  ><img src="../../../../../images/HP_Helion_logo_72.png" style="position: absolute;top: 10px;" alt="HP Helion" /></a>
        			<ul>
					
 

         
        				<li><a href="../../../../../../external.html?link=http://www8.hp.com/us/en/cloud/helion-portfolio.html">Helion@HP</a></li>
						<li><a href="../../../../../../external.html?link=https://h30580.www3.hp.com/">Support</a></li>
        				<li><a href="mailto:heliondocs@hp.com">Contact</a></li>
						
        				 
        			</ul>
      			</nav>
          </div>
      	</div>
		<!-- per JC
      	<div class="nav-wrapper wrapper container_16">
        	<a href="http://www.hpcloud.com/" class="logo"><img src="/images/HP_Helion_logo_72.png" alt="HP Helion" /></a>
      		<nav class="nav hide-320 show-768">
      			<ul>
      				<li><a href="http://hpcloud.com/products-services">Products <span>& Services</span></a></li>
      				<li><a href="http://hpcloud.com/solutions">Cloud <span>Solutions</span></a></li>
      				<li><a href="http://hpcloud.com/why-hp-cloud">Why HP <span>Cloud?</span></a></li>
      				<li><a href="http://hpcloud.com/learning-center">Learning <span>Center</span></a></li>
      				<li><a href="http://hpcloud.com/blog">The <span>Blog</span></a></li>
      				<li><a href="http://hpcloud.com/free-trial">Sign Up <span>Today</span></a></li>
      			</ul>
      		</nav>
      	</div>
		-->
      </header>
    </div>
		<div id="main-container">
			<div id="main" class="wrapper clearfix container_16">
				<div id="content" class="grid_10 suffix_1">
	<article>
		<!--PUBLISHED-->

<h1 id="port-service-harbor">HP Helion Development Platform: Port Service (Harbor)</h1>

<p>HTTP and HTTPS ports and routing are provided automatically for all web applications deployed to Application Lifecycle Service (unless <a href="../../deploy/manifestyml/index.html#web">processes:
web:</a> is set to
"\~").</p>

<p>If your application requires additional TCP or UDP ports, use the Harbor service to allocate them.</p>

<h2 id="requesting-a-port">Requesting a Port</h2>

<p>Additional ports are provisioned like any other data service. To request a port with the Helion command-line client:</p>

<pre>
  <code>helion create-service harbor debug-port
</code>
</pre>

<p>To request a port from Harbor in the <strong>manifest.yml</strong> file, add it in the <a href="../../deploy/manifestyml/index.html#services"><strong>services</strong></a> block.
For example:</p>

<pre>
  <code>name: port-test
mem: 256
services:
  my-port: harbor
</code>
</pre>

<p>This creates a TCP port tunnel which the application can access on the
host and port specified in the \$HELION_SERVICES environment
variable.</p>

<p>The example above might create the following "my-port" object in
\$HELION_SERVICES:</p>

<pre>
  <code>{
  "my-port": {
    "hostname": "192.168.68.111",
    "host": "192.168.68.111",
    "port": 30134,
    "name": "cf7f868a-8b7b-4ac8-ab4d-9fd87efb7c09",
    "node_id": "harbor_node_1",
    "int_port": 4100,
    "ext_hostname": "ports.example.com",
    "ext_host": "15.185.104.122"
  }
}
</code>
</pre>

<p>This provides the following information:</p>

<ul><li><strong>hostname</strong>: The internal hostname (if configured) of the node
providing the service (i.e. the Harbor node). If none is configured
by the admin, this will show the internal IP address.</li>
<li><strong>host</strong>: The internal IP address of the Harbor node.</li>
<li><strong>port</strong>: The external port number exposed by the service.
Connections from external clients and other internal applications
(those not directly bound to the service) will connect with this
port number.</li>
<li><strong>name</strong>: The service instance ID (Application Lifecycle Service internal refer).</li>
<li><strong>node_id</strong>: The Harbor node ID (Application Lifecycle Service internal).</li>
<li><strong>int_port</strong>: The port on the application container which forwards
to Harbor (see also <a href="#port-service-env-vars">Harbor Environment
Variables</a>). Application(s) bound to the
service should connect to this port.</li>
</ul><p>Access to the port from outside of the Application Lifecycle Service system/cluster may or
may not be exposed, depending on how the Harbor service is configured by
the Admin. If Harbor is set up to allow public port access, the
following two settings will also be shown:</p>

<ul><li><strong>ext_hostname</strong>: The public hostname (if configured) exposing the
port.</li>
<li><strong>ext_host</strong>: The public IP address exposing the port.</li>
</ul><p>
  <strong>Note</strong>
</p>

<p>To remotely check the settings and credentials of any Application Lifecycle Service service,
use the <a href="../../reference/client-ref/index.html#command-services"><strong>helion
service</strong></a> command.</p>

<h3 id="harbor-environment-variables">Harbor Environment Variables<a href="#harbor-environment-variables" title="Permalink to this headline"></a></h3>

<p>If there is only one Harbor service, the <strong>HELION_HARBOR</strong> environment variable can be used to get the internal port
number.</p>

<p>If there is more than one Harbor service, <strong>HELION_HARBOR</strong> is not available. Instead, a custom
<strong>HELION_HARBOR_&lt;SERVICE_NAME&gt;</strong> environment
variable will be created for each harbor service (service name
upper-cased with hyphens replaced by underscores).</p>

<p>For example, if your <em>manifest.yml</em> file configures the following
services:</p>

<pre>
  <code>services:
  udp-port: harbor
  tcp-port: harbor
</code>
</pre>

<p>Two environment variables would be created:
<code>HELION_HARBOR_UDP_PORT</code> and
<code>HELION_HARBOR_TCP_PORT</code>.</p>

<p>This naming scheme can be used in conjunction with the
<strong>HELION_APP_NAME_UPCASE</strong> environment variable. For
example, in an app with the following harbor services defined:</p>

<pre>
  <code>services:
  udp-${name}: harbor
  tcp-${name}: harbor
</code>
</pre>

<p>The Harbor port number for the UDP service could be accessed within the
container with a construct such as:</p>

<pre>
  <code>UDP_SERVICE_NAME=HELION_HARBOR_UDP_${HELION_APP_NAME_UPCASE}
UDP_SERVICE_PORT=${!UDP_SERVICE_NAME}
</code>
</pre>

<p>
  <strong>Note</strong>
</p>

<p>To use declarations like these in
<a href="../../deploy/manifestyml/index.html#hooks"><em>hooks</em></a>, put them in a
separate bash script. Brace expansion and grouping cannot be used directly in YAML files.</p>

<h2 id="setting-the-port-protocols">Setting the Port Protocols</h2>

<p>Harbor supports both the TCP and UDP protocols. When you provision a service with Harbor it will create a TCP enabled port by default. If you want to have a UDP port provisioned instead, you simply prefix your
service name with udp, for example:</p>

<pre>
  <code>helion create-service harbor udp-debug-port
</code>
</pre>

<p>If you have an application that requires both TCP <strong>and</strong> UDP, you can prefix your service name with either <em>multi-</em> or <em>both-</em> .
For example:</p>

<pre>
  <code>helion create-service harbor both-debug-port
</code>
</pre>

<p>Harbor will then create UDP and TCP proxies for your application so that applications like DNS can use both protocols on the same provisioned port.</p>

<h2 id="multiple-application-instances">Multiple Application Instances</h2>

<p>Harbor recognizes when you have multiple instances of your app running and will update the available app backends accordingly.</p>

<ul><li>For TCP connections it will round-robin between your available
backends on each new connection, in a similar fashion to the router
component.</li>
<li>For UDP this is not the case, as it is a stateless protocol. For
multiple UDP backends harbor will use a FIFO queue, that is the
first app instance available becomes the primary backend, and any
added later are queued.</li>
</ul><h2 id="https-via-harbor">HTTPS via Harbor<a href="#https-via-harbor" title="Permalink to this headline"></a></h2>

<p>SSL termination of HTTPS to applications hosted on Application Lifecycle Service normally
happens at the Router.</p>

<p>There is currently no mechanism for users to add SSL certificates for their own applications to the Router, but you can expose an external HTTPS interface via the Harbor port service which uses your SSL certificates.</p>

<p>To do this, upload the SSL certificate(s) and key(s) along with your application, and expose your application server directly on the TCP port provided by Harbor.</p>

<p>For example, an application running through the port service might have a URL such as: <em>https://harbor-node.helion.com:35048/</em></p>

<p>You can set up aliases to this URL using DNS, but the explicit port
specification must always be added.</p>

<p>
  <strong>Notes:</strong>
</p>

<ul><li>When using this approach, the hostname / IP address of the app will be the one provided by the Harbor node the client will connect using the Harbor-assigned port number, <strong>not</strong> 443.</li>
<li>Using Harbor in this way does <strong>not</strong> take advantage of any load balancing set up for regular web traffic through the Routers and Load Balancer.</li>
<li>If you have multiple instances of your app routing through a Harbor TCP port, connections will be distributed via round-robin.</li>
</ul><h3 id="https-container-proxy">HTTPS Container Proxy<a href="#https-container-proxy" title="Permalink to this headline"></a></h3>

<p>If you are using a framework such as Python or Perl which sets up uWSGI
(or any other framework that provides its own intermediate web server)
Harbor can provision an HTTPS server in the app container that forwards
HTTPS requests to the framework's HTTP server. To do this, add the
suffix <strong>https</strong> to the name of your Harbor service. For example:</p>

<pre>
  <code>name: harbor-test-app

services:
  custom-cert-https: harbor
</code>
</pre>

<p>Put your server certificate and key (named <em>harbor.crt</em> and <em>harbor.key</em>
respectively) in a folder called <em>certs</em> in the application's root
directory. For example:</p>

<pre>
  <code>app_root
    certs
    harbor.crt
    harbor.key
    ...
</code>
</pre>

<p>Alternatively, use a standalone or buildpack setup which provisions its
own intermediate web server instead.</p>

<h3 id="multiple-ssl-certificates">Multiple SSL Certificates<a href="#multiple-ssl-certificates" title="Permalink to this headline"></a></h3>

<p>If your application uses multiple SSL certificates, use the following
naming scheme:</p>

<ul><li><em>harbor service name</em>.key</li>
<li><em>harbor service name</em>.crt</li>
</ul><p>For example:</p>

<pre>
  <code>app_root
    certs
        harbor-https-custom-1.crt
        harbor-https-custom-2.key
    ...
</code>
</pre>

<p>The proxy will look for these certs before reverting to <code>harbor.crt</code> and <code>harbor.key</code>.</p>
	</article>
</div>

<div id="sidebar" class="grid_5 top-spacer">
	<aside class="signup-box">
		<p class="align-center">
			Download the<br>Development Platform<br>
			<a href="../../../../../../external.html?link=https://helion.hpwsportal.com/#/Home/Show">DOWNLOAD NOW</a>
		</p>
	</aside>
	
 
	<aside class="signup-box">
		<p class="align-center">
			Take the Helion Development Platform for a Free Spin<br>
			<a href="../../../../../helion/devplatform/ALS-developer-trial-quick-start/index.html">Quick Start Developer Trial</a>
		</p>
	</aside>
<!--	
	<aside class="signup-box">
		<p class="align-center">Make sure to check out our Developer Portal
			<a href="https://dev.hpcloud.com">dev.hpcloud.com
</a><br>
 
		</p>
	</aside>
-->	
	<aside class="box section-navigation">
  
     
  
  <ul>
    
      
      
      <li>
        <a class="" href="../../../../../index.html"><span>HP Helion Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/index.html"><span>HP Helion Development Platform Documentation Home</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/install/index.html"><span>Development Platform Installation & Configuration</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/install/community/index.html"><span>Development Platform Community Edition Installation & Configuration</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/openstack/update/devplat/101/index.html"><span>Development Platform Commercial 1.0.1 Update</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/appdev/index.html"><span>Application Developer Resources</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/sysadmin/index.html"><span>IT Ops Resources</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/appdev/index.html#sample"><span>Sample Code</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/release-notes/index.html"><span>Release Notes</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/related-topics/index.html"><span>Related Documentation</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/deploy/index.html"><span>Application Lifecycle Service Configuration and Deployment</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../admin/index.html"><span>ALS Admin Guide</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/eula/index.html"><span>End User License Agreement</span></a>
      </li>
    
      
      
      <li>
        <a class="" href="../../../../../helion/devplatform/3rd-party-license-agreements/index.html"><span>Open Source and Third-Party Software License Agreements</span></a>
      </li>
    
  </ul>
</aside>
</div>

			</div> <!-- #main -->
		</div> <!-- #main-container -->
	</div> <!-- #wrapper -->

		
  <footer class="footer">
    <div class="container_16">
    	<div class="wrapper grid_16">
    		<ul class="footer-social">
    			<li class="twitter"><a href="../../../../../../external.html?link=https://twitter.com/hphelioncloud"></a></li>
    			<li class="youtube"><a href="../../../../../../external.html?link=http://www.youtube.com/hpcloud"></a></li>
    			<li class="rss"><a href="../../../../../../external.html?link=http://h30499.www3.hp.com/hpeb/rss/board?board.id=sws-661"></a></li>
    			<li class="facebook"><a href="../../../../../../external.html?link=https://www.facebook.com/HPCloud"></a></li>
    			<li class="linkedin stretch"><a href="../../../../../../external.html?link=https://www.linkedin.com/company/hewlett-packard"></a></li>
    		</ul>
    		<ul class="contact-info">
    			<li>In the U.S.<br />1-855-61CLOUD</li>
    			<li>Worldwide<br />+1678-745-9010</li>
    			<li class="col-3">Online Support<br /><a href="mailto:support@hpcloud.com">Email</a> 
				<!-- comment out per JC
				or <span class="link" onclick="jQuery('#hpcloud-chat-button a').click();">Chat with us</span>
				-->
				</li>
    		</ul>
    		<div class="copyright">
    			<p>The OpenStack&reg; Word Mark and OpenStack Logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.</p><br />
    			<p>&copy; 2014 Hewlett-Packard Development Company, L.P.<br /><a href="../../../../../../external.html?link=http://www.hpcloud.com/legal-documents">HP Cloud legal documents and privacy policy</a></p>
    		</div>
    	</div>
    </div>
  </footer>

	<script src="../../../../../../ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="../../../../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../../../../js/jquery-1.8.2f.min.html"><\/script>')</script>

  <script src="../../../../../js/combined.js"></script>
  <script>
      __HP_CHAT_CONF = {};
      __HP_CHAT_CONF.sales = true;
      __HP_CHAT_CONF.support = true;
    </script>
	
    <script> //removed per JC
    //(function($, window) {
    //    $(window).load(function() {
    //    var sNew = document.createElement("script");
    //  sNew.async = true;
    //sNew.src = 'https://a248.e.akamai.net/cdn.hpcloudsvc.com/gcbb18d905d32174e6eb205943b0dea4a/prodae1/chat.js';
    //var s0 = document.getElementsByTagName('script')[0];
    //s0.parentNode.insertBefore(sNew, s0);
    //});
    //})(jQuery, this);
    </script>
    <script>
        //Executes your code when the DOM is ready.  Acts the same as $(document).ready().
        function styleRestCmds() {
            $("h5:contains('GET')").addClass('rest_cmd cmd_get');
            $("h5:contains('POST')").addClass('rest_cmd cmd_post');
            $("h5:contains('FormPOST')").removeClass('rest_cmd cmd_post');
            $("h5:contains('PUT')").addClass('rest_cmd cmd_put');
            $("h5:contains('COPY')").addClass('rest_cmd cmd_copy');
            $("h5:contains('PATCH')").addClass('rest_cmd cmd_patch');
            $("h5:contains('HEAD')").addClass('rest_cmd cmd_head');
            $("h5:contains('DELETE')").addClass('rest_cmd cmd_delete');
        }

        $(function() {
            //Calls the tocify method on your HTML div.
            $("#toc").tocify({
                'selectors': 'h2,h3,h4',
                'showAndHideOnScroll': false,
                'hideEffect': 'slideUp',
                'scrollTo': 55    // Amount of space between top of page and selected content
              }
            );
            // Style the REST commands
            styleRestCmds();
        });
    </script>
</body>

<!-- Mirrored from docs.hpcloud.com/als/v1/user/services/port-service/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Feb 2015 15:04:26 GMT -->
</html>
